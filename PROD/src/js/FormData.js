export default class FormData{constructor(){this.form=document.querySelector("#form"),this.saveEntr,this.userEntries=[],this.userSelections=[],this.savedInquiry=JSON.parse(localStorage.getItem("saveInquiry"))||[],this.savedPerformanceSelection=JSON.parse(localStorage.getItem("savePerformanceSelection"))||[],localStorage.removeItem("savePerformanceSelection"),this.validEmail=/^[a-zA-Z0-9._-]+@[a-zA-Z0-9.-]+\.[a-zA-Z]{2,4}$/,this.userInputSend=document.querySelector(".sended-user-input-container"),this.userInputSendContent=document.querySelector(".sended-user-input"),this.form?(this.headlineInputSend=this.userInputSendContent.querySelector("h2"),this.paragraphInputSend=this.userInputSendContent.querySelector("p"),this.colorAlert="#ff7f50",this.colorSuccess="#b4ffd8",this.userInputSendBtn=document.querySelector(".user-input-sended-btn"),this.userInputCancelBtn=document.querySelector(".hide-no-btn")):console.log("Form does not exist!")}start(){this.savedInquiry&&this.savedInquiry.length>=0&&(this.userEntries=this.savedInquiry),this.form&&(this.getUserInfoBtn(),this.getInputValuesAndBuildObject())}getUserInfoBtn(){this.userInputSendContent.addEventListener("click",e=>{e.target.innerHTML.match("Ja")?setTimeout(()=>{this.userInputCancelBtn.style.display="none",this.saveUserEntries(this.saveEntr)},1e3):e.target.innerHTML.match("Nein")?(this.userInputCancelBtn.style.display="none",this.validatAndBuildSendStateWindow(!1)):e.target.innerHTML.match("Schließen")&&(this.userInputSend.style.display="none")})}getInputValuesAndBuildObject(){this.form.addEventListener("submit",e=>{e.preventDefault();const t=document.querySelector("#name").value,n=document.querySelector("#last-name").value,s=document.querySelector("#email").value,i=document.querySelector("#tele-number").value,r=document.querySelector("#message").value,a={name:t,lastName:n,email:s,telephone:i,message:r};this.userInputCancelBtn.style.display="inline-block",this.checkEntriesValid(a)})}checkEntriesValid(e){e.email.match(this.validEmail)&&this.form?this.areTheEntriesCorrectWindow(e):(this.userInputCancelBtn.style.display="none",this.validatAndBuildSendStateWindow("mail-unvalid"))}areTheEntriesCorrectWindow(e){const t=`Name: ${e.name}`,n=`Nachname: ${e.lastName}`,s=`Email: ${e.email}`,i=`Telefon: ${e.telephone}`,r=`Nachricht: ${e.message}`,a=` Auswahl: ${JSON.stringify(this.savedPerformanceSelection).replace(/,/g,", ")}`,l=[t,n,s,i,r,a];this.validatAndBuildSendStateWindow(l,e)}saveUserEntries(e){this.userEntries.push(e),localStorage.setItem("saveInquiry",JSON.stringify(e)),this.userEntries=[],this.userEntries.push(this.savedInquiry),localStorage.removeItem("saveInquiry"),this.form.reset(),this.getSavedPerformanceSelection()}getSavedPerformanceSelection(){let e={};this.savedPerformanceSelection.forEach((t,n)=>{let s="selection"+n;e[s]=t}),this.userEntries[0].push(e),this.validatAndBuildSendStateWindow(!0)}validatAndBuildSendStateWindow(e,t){let n,s,i,r,a;switch(Array.isArray(e)&&(a=e,e="Array"),e){case!0:n="Erfolgreich abgesendet!",s="Vielen Dank für Ihr Vertrauen. Wir haben Ihre Anfrage erhalten und werden uns schnellstmöglich darum kümmern.",i="Schließen",r=this.colorSuccess,this.buildUserInformationWindow(n,s,i,r);break;case"mail-unvalid":n="Upps, da ist etwas schiefgelaufen. Versuchen Sie es noch einmal!",s="Die von Ihnen eingegebene Email Adresse entspricht nicht dem gängigen Format für Email Adressen",i="Schließen",r=this.colorAlert,this.buildUserInformationWindow(n,s,i,r);break;case"Array":n="Sind Ihre Angaben richtig?";let l=0;s=JSON.stringify(a).replace(/,/g,e=>(l++,l<=4?"\n":e)),s=s.replace(/["\\\[\]]/g,""),s=s.split(/, Auswahl:/g).join("\n\nAuswahl:\n"),s=s.replace(/Nachricht:/g,"\nNachricht:\n"),i="Ja",r=this.colorSuccess,this.saveEntr=t,this.buildUserInformationWindow(n,s,i,r);break;case!1:n="Upps, da ist was schief gelaufen. Versuchen sie es noch einmal!",s="Klicken Sie auf Schließen und korrigieren Sie den falschen Eintrag (Die Einträge in den Eingabefeldern bleiben erhalten).",i="Schließen",r=this.colorAlert,this.buildUserInformationWindow(n,s,i,r)}}buildUserInformationWindow(e,t,n,s){this.headlineInputSend.textContent=e,this.paragraphInputSend.textContent=t,this.userInputSendBtn.textContent=n,this.userInputSendBtn.style.color=s,this.headlineInputSend.style.color=s,this.paragraphInputSend.style.color=s,this.openUserInputSendWindow()}openUserInputSendWindow(){this.userInputSend.style.display="flex"}}